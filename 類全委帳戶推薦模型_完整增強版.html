<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡å…¨å§”å¸³æˆ¶æ¨è–¦æ¨¡å‹ + å¸‚å ´åˆ†æç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        /* é ç±¤æ¨£å¼ */
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #667eea;
        }
        
        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1em;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
            color: #6c757d;
        }
        
        .tab:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
            margin-bottom: -3px;
        }
        
        .tab-content {
            display: none;
            padding: 40px;
            animation: fadeIn 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* åŸæœ‰è©•åˆ†ç³»çµ±æ¨£å¼ */
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .file-upload-section {
            flex: 1;
            min-width: 250px;
        }
        
        .file-upload-section label {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .file-upload-section input[type="file"] {
            width: 100%;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            font-size: 0.9em;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(56, 239, 125, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }
        
        .weights {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #2196F3;
        }
        
        .weights h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .weight-item {
            display: inline-block;
            margin: 5px 15px 5px 0;
            padding: 8px 15px;
            background: white;
            border-radius: 20px;
            font-weight: 600;
            color: #1976d2;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .status-message {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            font-weight: 600;
        }
        
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .results-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .results-header h2 {
            margin-bottom: 10px;
        }
        
        .results-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            margin-top: 5px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            font-weight: 600;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        tbody tr {
            transition: background 0.3s ease;
        }
        
        tbody tr:hover {
            background: #f5f5f5;
        }
        
        .rank-badge {
            display: inline-block;
            width: 35px;
            height: 35px;
            line-height: 35px;
            text-align: center;
            border-radius: 50%;
            font-weight: bold;
            color: white;
        }
        
        .rank-1 {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.5);
        }
        
        .rank-2 {
            background: linear-gradient(135deg, #C0C0C0, #808080);
            box-shadow: 0 2px 8px rgba(192, 192, 192, 0.5);
        }
        
        .rank-3 {
            background: linear-gradient(135deg, #CD7F32, #8B4513);
            box-shadow: 0 2px 8px rgba(205, 127, 50, 0.5);
        }
        
        .rank-other {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }
        
        .excluded-row {
            opacity: 0.6;
            background: #fff3cd !important;
        }
        
        .excluded-badge {
            background: #ffc107;
            color: #856404;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .score-cell {
            font-weight: 600;
            color: #667eea;
        }
        
        /* å¸‚å ´åˆ†æé é¢æ¨£å¼ */
        .market-analysis-container {
            display: grid;
            gap: 20px;
        }
        
        .analysis-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .analysis-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .input-area {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
        }
        
        .input-area:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .file-list {
            list-style: none;
            margin-top: 15px;
        }
        
        .file-list li {
            background: white;
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .file-list .file-name {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .file-list .file-size {
            color: #6c757d;
            font-size: 0.9em;
        }
        
        .report-container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .report-header h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .report-date {
            color: #6c757d;
            font-size: 1em;
        }
        
        .report-section {
            margin-bottom: 30px;
        }
        
        .report-section h3 {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 15px;
            padding-left: 15px;
            border-left: 4px solid #667eea;
        }
        
        .report-content {
            line-height: 1.8;
            color: #2c3e50;
            text-align: justify;
        }
        
        .report-list {
            list-style: none;
            padding-left: 20px;
        }
        
        .report-list li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 25px;
        }
        
        .report-list li:before {
            content: "â–¶";
            position: absolute;
            left: 0;
            color: #667eea;
            font-size: 0.8em;
        }
        
        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .chart-title {
            text-align: center;
            color: #2c3e50;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        canvas {
            max-width: 100%;
            height: auto !important;
        }
        
        .data-table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        .data-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }
        
        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .positive {
            color: #28a745;
            font-weight: 600;
        }
        
        .negative {
            color: #dc3545;
            font-weight: 600;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
            }
            .header, .tabs, .action-buttons {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .tab {
                padding: 15px 10px;
                font-size: 0.9em;
            }
            
            .tab-content {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            table {
                font-size: 0.85em;
            }
            
            th, td {
                padding: 10px 8px;
            }
        }
    </style>
    <!-- å¼•å…¥å¿…è¦çš„å‡½å¼åº« -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† é¡å…¨å§”å¸³æˆ¶æ¨è–¦æ¨¡å‹ + å¸‚å ´åˆ†æç³»çµ±</h1>
            <div class="subtitle">Discretionary Account Recommendation & Market Analysis System</div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('scoring')">ğŸ“Š å¸³æˆ¶è©•åˆ†ç³»çµ±</button>
            <button class="tab" onclick="switchTab('market')">ğŸ“ˆ å¸‚å ´åˆ†æå ±å‘Š</button>
        </div>
        
        <!-- å¸³æˆ¶è©•åˆ†ç³»çµ±é ç±¤ -->
        <div id="scoring-tab" class="tab-content active">
            <div class="controls">
                <div class="file-upload-section">
                    <label for="accountFile">é¡å…¨å§”å¸³æˆ¶è³‡è¨Š Excel:</label>
                    <input type="file" id="accountFile" accept=".xlsx,.xls">
                </div>
                <div class="file-upload-section">
                    <label for="strategyFile">æŠ•è³‡ç­–ç•¥éƒ¨ Excel:</label>
                    <input type="file" id="strategyFile" accept=".xlsx,.xls">
                </div>
                <button class="btn-primary" onclick="processUploadedFiles()">è™•ç†ä¸Šå‚³çš„æª”æ¡ˆä¸¦é‡æ–°è¨ˆç®—</button>
                <button class="btn-success" onclick="exportToExcel()">åŒ¯å‡º Excel å ±å‘Š</button>
            </div>
            
            <div id="statusMessage" class="status-message"></div>
            
            <div class="weights">
                <h3>ğŸ“Š è©•åˆ†é…ç½®</h3>
                <div>
                    <span class="weight-item">ç¸¾æ•ˆ 45%</span>
                    <span class="weight-item">å¸‚å ´é…ç½® 15%</span>
                    <span class="weight-item">ç”¢æ¥­é…ç½® 15%</span>
                    <span class="weight-item">è‚¡å‚µé…ç½® 15%</span>
                    <span class="weight-item">æ³¢å‹•åº¦ 10%</span>
                    <span class="weight-item">åŠ ç¢¼æ’¥å›åŠ åˆ† 0.05</span>
                </div>
            </div>
            
            <div class="results-header">
                <h2>ğŸ† è©•åˆ†çµæœ</h2>
                <div class="results-stats">
                    <div class="stat-item">
                        <div class="stat-label">ç¸½å¸³æˆ¶æ•¸</div>
                        <div class="stat-value" id="totalAccounts">-</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">ç¬¦åˆè¦æ¨¡å¸³æˆ¶</div>
                        <div class="stat-value" id="qualifiedAccounts">-</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">æ’é™¤å¸³æˆ¶</div>
                        <div class="stat-value" id="excludedAccounts">-</div>
                    </div>
                </div>
            </div>
            
            <div id="results"></div>
        </div>
        
        <!-- å¸‚å ´åˆ†æå ±å‘Šé ç±¤ -->
        <div id="market-tab" class="tab-content">
            <div class="market-analysis-container">
                <div class="analysis-section">
                    <h3>ğŸ“ å¸‚å ´è³‡è¨Šè¼¸å…¥</h3>
                    <p style="margin-bottom: 15px; color: #6c757d;">è«‹è²¼ä¸Šæˆ–è¼¸å…¥æœ€æ–°çš„å¸‚å ´è³‡è¨Šï¼ˆæ”¯æ´å…¨çƒè‚¡å¸‚ã€ç¾è‚¡ã€å°è‚¡ã€å‚µåˆ¸ã€é»ƒé‡‘ç­‰ï¼‰</p>
                    <textarea id="marketInfoInput" class="input-area" placeholder="ç¯„ä¾‹ï¼š
ç¾è‚¡ï¼šS&P 500æŒ‡æ•¸æ”¶ç›¤æ–¼4,783é»ï¼Œä¸Šæ¼²0.8%...
å°è‚¡ï¼šåŠ æ¬ŠæŒ‡æ•¸æ”¶ç›¤æ–¼17,830é»ï¼Œç§‘æŠ€è‚¡è¡¨ç¾å¼·å‹...
å‚µåˆ¸ï¼šç¾åœ‹10å¹´æœŸå…¬å‚µæ®–åˆ©ç‡ç‚º4.2%...
é»ƒé‡‘ï¼šç¾è²¨é»ƒé‡‘æ¯ç›å¸2,050ç¾å…ƒ...

æ‚¨å¯ä»¥å¾å„å¤§è²¡ç¶“ç¶²ç«™ï¼ˆå¦‚ï¼šBloombergã€Reutersã€Yahoo Financeã€é‰…äº¨ç¶²ç­‰ï¼‰è¤‡è£½ç›¸é—œå¸‚å ´è³‡è¨Šè²¼ä¸Šã€‚"></textarea>
                </div>
                
                <div class="analysis-section">
                    <h3>ğŸ“ ä¸Šå‚³å¸‚å ´å±•æœ›å ±å‘Š</h3>
                    <p style="margin-bottom: 15px; color: #6c757d;">æ”¯æ´ä¸Šå‚³æ–‡å­—æª”æ¡ˆï¼ˆ.txt, .mdï¼‰æˆ–ç›´æ¥è²¼ä¸Šå ±å‘Šå…§å®¹</p>
                    <input type="file" id="marketReports" accept=".txt,.md,.pdf" multiple style="margin-bottom: 15px;">
                    <ul id="fileList" class="file-list"></ul>
                    <textarea id="reportInput" class="input-area" placeholder="æˆ–ç›´æ¥è²¼ä¸Šå¸‚å ´å±•æœ›å ±å‘Šå…§å®¹..."></textarea>
                </div>
                
                <div class="action-buttons">
                    <button class="btn-primary" onclick="generateMarketReport()">ğŸ” ç”Ÿæˆå¸‚å ´åˆ†æå ±å‘Š</button>
                    <button class="btn-success" onclick="exportReportToPDF()">ğŸ“„ åŒ¯å‡º PDF å ±å‘Š</button>
                    <button class="btn-warning" onclick="clearMarketData()">ğŸ”„ æ¸…é™¤è³‡æ–™</button>
                </div>
                
                <div id="marketStatusMessage" class="status-message"></div>
            </div>
            
            <div id="reportOutput" style="display: none;">
                <div class="report-container" id="reportContent">
                    <!-- å ±å‘Šå…§å®¹å°‡å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== è³‡æ–™å€ ====================
        const DATA = {
  "accounts": [
    {
      "code": "FF012",
      "insurance_company": "å°æ–°äººå£½",
      "fund_company": "å¾©è¯æŠ•ä¿¡",
      "name": "è¶¨å‹¢é›™ç›ˆ",
      "scale": 3090772757.4179964,
      "stock_allocation": 68.47000000000001,
      "bond_allocation": 29.17,
      "volatility": 0.11658099999999999,
      "drawdown_rate": 0.0625,
      "perf_3m": 10.6353,
      "perf_6m": 24.1494,
      "perf_1y": 10.0333,
      "perf_2y": null,
      "perf_since": 12.4147,
      "markets": {
        "ç¾åœ‹": 0.4193,
        "æ­æ´²": 0.044000000000000004,
        "æ—¥æœ¬": 0.0232,
        "ä¸­åœ‹": 0.020099999999999996,
        "å°ç£": 0.32899999999999996,
        "å°åº¦": 0.0030000000000000005,
        "éŸ“åœ‹": 0.006999999999999999,
        "æ±å—äº": 0.0111,
        "å·´è¥¿": 0.0046,
        "å¢¨è¥¿å“¥": 0.0092,
        "æ–°èˆˆæ­": 0.011000000000000001
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0454,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0154,
        "é†«ç™‚ä¿å¥": 0.022099999999999998,
        "è³‡è¨ŠæŠ€è¡“": 0.3835,
        "é€šè¨Šæœå‹™": 0.0373,
        "å…¬ç”¨äº‹æ¥­": 0.0063,
        "æˆ¿åœ°ç”¢": 0.0012,
        "é‡‘è": 0.0684,
        "å·¥æ¥­": 0.0641,
        "èƒ½æº": 0.009899999999999999,
        "åŸææ–™": 0.011200000000000002
      }
    },
    {
      "code": "FF010",
      "insurance_company": "å°æ–°äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "å¤šé‡æ™‚æ©Ÿ",
      "scale": 8185237228.639097,
      "stock_allocation": 54.43,
      "bond_allocation": 39.839999999999996,
      "volatility": 0.10157,
      "drawdown_rate": 0.96,
      "perf_3m": 3.2785,
      "perf_6m": 8.4711,
      "perf_1y": 8.145,
      "perf_2y": 26.7465,
      "perf_since": 33.8822,
      "markets": {
        "ç¾åœ‹": 0.6057,
        "æ­æ´²": 0.0642,
        "æ—¥æœ¬": 0.0015,
        "ä¸­åœ‹": 0.0011,
        "å°ç£": 0.0037,
        "å°åº¦": 0.0019,
        "éŸ“åœ‹": 0.0014,
        "æ±å—äº": 0.008,
        "å·´è¥¿": 0.0019,
        "å¢¨è¥¿å“¥": 0.0083,
        "æ–°èˆˆæ­": 0.0101
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0481,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0532,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.2399,
        "é€šè¨Šæœå‹™": 0.1533,
        "å…¬ç”¨äº‹æ¥­": 0.0376,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0846,
        "å·¥æ¥­": 0.0276,
        "èƒ½æº": 0.0282,
        "åŸææ–™": 0.0103
      }
    },
    {
      "code": "FF007",
      "insurance_company": "å°æ–°äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "å…¨æ–°å‹¢åŠ›",
      "scale": 3318325181.198987,
      "stock_allocation": 63.839999999999996,
      "bond_allocation": 32.28,
      "volatility": 0.122249,
      "drawdown_rate": 0.52,
      "perf_3m": 3.4371,
      "perf_6m": 8.9165,
      "perf_1y": 8.7632,
      "perf_2y": 28.8725,
      "perf_since": 29.321,
      "markets": {
        "ç¾åœ‹": 0.6373,
        "æ­æ´²": 0.0522,
        "æ—¥æœ¬": 0.0049,
        "ä¸­åœ‹": 0.0045,
        "å°ç£": 0.0048,
        "å°åº¦": 0.0022,
        "éŸ“åœ‹": 0.0016,
        "æ±å—äº": 0.0102,
        "å·´è¥¿": 0.0035,
        "å¢¨è¥¿å“¥": 0.008,
        "æ–°èˆˆæ­": 0.0098
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0413,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0444,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.2867,
        "é€šè¨Šæœå‹™": 0.1648,
        "å…¬ç”¨äº‹æ¥­": 0.045,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0706,
        "å·¥æ¥­": 0.0246,
        "èƒ½æº": 0.0223,
        "åŸææ–™": 0.0086
      }
    },
    {
      "code": "FF009",
      "insurance_company": "å°æ–°äººå£½",
      "fund_company": "å®åˆ©æŠ•ä¿¡",
      "name": "å‹åˆ©é›™äº«",
      "scale": 1580892038.2792618,
      "stock_allocation": 70.24000000000001,
      "bond_allocation": 28.000000000000004,
      "volatility": 0.118582,
      "drawdown_rate": 0.4815,
      "perf_3m": 4.397,
      "perf_6m": 10.2148,
      "perf_1y": 7.1749,
      "perf_2y": 22.6515,
      "perf_since": 22.6871,
      "markets": {
        "ç¾åœ‹": 0.8929,
        "æ­æ´²": 0.0424,
        "æ—¥æœ¬": 0.0029,
        "ä¸­åœ‹": 0.0057,
        "å°ç£": 0.007,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.005,
        "æ±å—äº": 0.0017,
        "å·´è¥¿": 0.003,
        "å¢¨è¥¿å“¥": 0.0041,
        "æ–°èˆˆæ­": 0.0027
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.047,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0098,
        "é†«ç™‚ä¿å¥": 0.0173,
        "è³‡è¨ŠæŠ€è¡“": 0.2833,
        "é€šè¨Šæœå‹™": 0.0693,
        "å…¬ç”¨äº‹æ¥­": 0.0643,
        "æˆ¿åœ°ç”¢": 0.0137,
        "é‡‘è": 0.0109,
        "å·¥æ¥­": 0.0691,
        "èƒ½æº": 0.0346,
        "åŸææ–™": 0.0033
      }
    },
    {
      "code": "FF008",
      "insurance_company": "å°æ–°äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "è¶¨å‹•å°ç£",
      "scale": 2577541567.696296,
      "stock_allocation": 87.09,
      "bond_allocation": 0.0,
      "volatility": 0.20977,
      "drawdown_rate": 0.85,
      "perf_3m": 11.9592,
      "perf_6m": 35.6578,
      "perf_1y": 22.1769,
      "perf_2y": 53.5388,
      "perf_since": 59.2925,
      "markets": {
        "ç¾åœ‹": 0.0,
        "æ­æ´²": 0.0,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0,
        "å°ç£": 0.8709,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0202,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0188,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.4066,
        "é€šè¨Šæœå‹™": 0.0334,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0121,
        "å·¥æ¥­": 0.2327,
        "èƒ½æº": 0.0008,
        "åŸææ–™": 0.0118
      }
    },
    {
      "code": "FF014",
      "insurance_company": "å°æ–°äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "ç¾åœ‹ç©©ç›ˆ",
      "scale": 4931707124.58054,
      "stock_allocation": 59.89,
      "bond_allocation": 34.449999999999996,
      "volatility": 0.0,
      "drawdown_rate": 0.67,
      "perf_3m": 2.7516,
      "perf_6m": 3.6842,
      "perf_1y": null,
      "perf_2y": null,
      "perf_since": 3.6842,
      "markets": {
        "ç¾åœ‹": 0.6303,
        "æ­æ´²": 0.0821,
        "æ—¥æœ¬": 0.002,
        "ä¸­åœ‹": 0.0012,
        "å°ç£": 0.0041,
        "å°åº¦": 0.0018,
        "éŸ“åœ‹": 0.0018,
        "æ±å—äº": 0.0071,
        "å·´è¥¿": 0.0023,
        "å¢¨è¥¿å“¥": 0.0078,
        "æ–°èˆˆæ­": 0.0089
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0555,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0586,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.2462,
        "é€šè¨Šæœå‹™": 0.1584,
        "å…¬ç”¨äº‹æ¥­": 0.0591,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0757,
        "å·¥æ¥­": 0.0495,
        "èƒ½æº": 0.031,
        "åŸææ–™": 0.0108
      }
    },
    {
      "code": "DMA124",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å®‰è¯æŠ•ä¿¡",
      "name": "å¥½å‹¢æ‰¿é›™",
      "scale": 1473788184.2089982,
      "stock_allocation": 0.0,
      "bond_allocation": 0.0,
      "volatility": 0.0,
      "drawdown_rate": 0.0,
      "perf_3m": null,
      "perf_6m": null,
      "perf_1y": null,
      "perf_2y": null,
      "perf_since": 1.1,
      "markets": {
        "ç¾åœ‹": 0.0,
        "æ­æ´²": 0.0,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.0,
        "é€šè¨Šæœå‹™": 0.0,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0,
        "å·¥æ¥­": 0.0,
        "èƒ½æº": 0.0,
        "åŸææ–™": 0.0
      }
    },
    {
      "code": "DMA071",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "è²èŠæŠ•ä¿¡",
      "name": "ç’°çƒå¾—åˆ©",
      "scale": 7161316100.404261,
      "stock_allocation": 62.2,
      "bond_allocation": 37.2,
      "volatility": 0.086282,
      "drawdown_rate": 0.09523809523809523,
      "perf_3m": 3.7212,
      "perf_6m": 9.1313,
      "perf_1y": 9.7509,
      "perf_2y": 27.8127,
      "perf_since": 38.5642,
      "markets": {
        "ç¾åœ‹": 0.724,
        "æ­æ´²": 0.045,
        "æ—¥æœ¬": 0.0239,
        "ä¸­åœ‹": 0.0238,
        "å°ç£": 0.0264,
        "å°åº¦": 0.0229,
        "éŸ“åœ‹": 0.0175,
        "æ±å—äº": 0.02,
        "å·´è¥¿": 0.0095,
        "å¢¨è¥¿å“¥": 0.0074,
        "æ–°èˆˆæ­": 0.01
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0705,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0261,
        "é†«ç™‚ä¿å¥": 0.0421,
        "è³‡è¨ŠæŠ€è¡“": 0.2303,
        "é€šè¨Šæœå‹™": 0.071,
        "å…¬ç”¨äº‹æ¥­": 0.0183,
        "æˆ¿åœ°ç”¢": 0.0119,
        "é‡‘è": 0.12,
        "å·¥æ¥­": 0.0641,
        "èƒ½æº": 0.0246,
        "åŸææ–™": 0.0276
      }
    },
    {
      "code": "DMA085",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "éœ¸è±æŠ•é¡§",
      "name": "æ°¸çºŒä½³åˆ©",
      "scale": 1631818461.212072,
      "stock_allocation": 50.5,
      "bond_allocation": 44.0,
      "volatility": 0.085159,
      "drawdown_rate": 0.0,
      "perf_3m": 3.0555,
      "perf_6m": 7.6557,
      "perf_1y": 4.9109,
      "perf_2y": 21.0326,
      "perf_since": 3.1339,
      "markets": {
        "ç¾åœ‹": 0.575,
        "æ­æ´²": 0.14,
        "æ—¥æœ¬": 0.046,
        "ä¸­åœ‹": 0.028,
        "å°ç£": 0.009,
        "å°åº¦": 0.007,
        "éŸ“åœ‹": 0.008,
        "æ±å—äº": 0.004,
        "å·´è¥¿": 0.004,
        "å¢¨è¥¿å“¥": 0.006,
        "æ–°èˆˆæ­": 0.014
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.069,
        "æ ¸å¿ƒæ¶ˆè²»": 0.021,
        "é†«ç™‚ä¿å¥": 0.037,
        "è³‡è¨ŠæŠ€è¡“": 0.175,
        "é€šè¨Šæœå‹™": 0.046,
        "å…¬ç”¨äº‹æ¥­": 0.022,
        "æˆ¿åœ°ç”¢": 0.007,
        "é‡‘è": 0.069,
        "å·¥æ¥­": 0.052,
        "èƒ½æº": 0.012,
        "åŸææ–™": 0.017
      }
    },
    {
      "code": "DMA103",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "å‰ç»é¢¨æ§",
      "scale": 1004154795.8399775,
      "stock_allocation": 46.239999999999995,
      "bond_allocation": 49.63,
      "volatility": 0.090847,
      "drawdown_rate": 0.0,
      "perf_3m": 2.5499,
      "perf_6m": 7.5787,
      "perf_1y": 7.528,
      "perf_2y": 23.2009,
      "perf_since": 22.511,
      "markets": {
        "ç¾åœ‹": 0.45896861552215995,
        "æ­æ´²": 0.17261605701006003,
        "æ—¥æœ¬": 0.02860044545039999,
        "ä¸­åœ‹": 0.012310734701799999,
        "å°ç£": 0.011026903731000001,
        "å°åº¦": 0.008705013754,
        "éŸ“åœ‹": 0.0092568946555,
        "æ±å—äº": 0.010310811271000002,
        "å·´è¥¿": 0.003513916636999999,
        "å¢¨è¥¿å“¥": 0.0088057642343,
        "æ–°èˆˆæ­": 0.010497030039200002
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.04529027647712001,
        "æ ¸å¿ƒæ¶ˆè²»": 0.055706868095879984,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.05150767565722,
        "é€šè¨Šæœå‹™": 0.039756032646160004,
        "å…¬ç”¨äº‹æ¥­": 0.025586975935320003,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.17836018826741998,
        "å·¥æ¥­": 0.03642346420198,
        "èƒ½æº": 0.03599522510282,
        "åŸææ–™": 0.014281079584239999
      }
    },
    {
      "code": "DMA077",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "ç¾æ­åƒ¹å€¼",
      "scale": 586288850.0763576,
      "stock_allocation": 69.12,
      "bond_allocation": 27.08,
      "volatility": 0.096721,
      "drawdown_rate": 0.0,
      "perf_3m": 1.0427,
      "perf_6m": 4.1527,
      "perf_1y": 4.3922,
      "perf_2y": 19.9721,
      "perf_since": 17.7055,
      "markets": {
        "ç¾åœ‹": 0.773,
        "æ­æ´²": 0.189,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.062697068768,
        "æ ¸å¿ƒæ¶ˆè²»": 0.224011420492,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.024837156341999997,
        "é€šè¨Šæœå‹™": 0.159311460616,
        "å…¬ç”¨äº‹æ¥­": 0.011400065261999999,
        "æˆ¿åœ°ç”¢": 0.1261,
        "é‡‘è": 0.07441068095999999,
        "å·¥æ¥­": 0.016649774171999997,
        "èƒ½æº": 0.067412576112,
        "åŸææ–™": 0.17288549341
      }
    },
    {
      "code": "DMA052",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å¾©è¯æŠ•ä¿¡",
      "name": "å°ç£æ–°ç›Š",
      "scale": 819999515.0930997,
      "stock_allocation": 48.835,
      "bond_allocation": 26.625000000000004,
      "volatility": 0.104648,
      "drawdown_rate": 0.0,
      "perf_3m": 11.6544,
      "perf_6m": 30.0089,
      "perf_1y": 29.6336,
      "perf_2y": 52.9905,
      "perf_since": 108.0495,
      "markets": {
        "ç¾åœ‹": 0.1505,
        "æ­æ´²": 0.019799999999999998,
        "æ—¥æœ¬": 0.0027,
        "ä¸­åœ‹": 0.0002,
        "å°ç£": 0.5183,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0006,
        "æ±å—äº": 0.0001,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0199,
        "æ ¸å¿ƒæ¶ˆè²»": 0.005600000000000001,
        "é†«ç™‚ä¿å¥": 0.0026,
        "è³‡è¨ŠæŠ€è¡“": 0.37810000000000005,
        "é€šè¨Šæœå‹™": 0.0070999999999999995,
        "å…¬ç”¨äº‹æ¥­": 0.0001,
        "æˆ¿åœ°ç”¢": 0.0006,
        "é‡‘è": 0.0401,
        "å·¥æ¥­": 0.052300000000000006,
        "èƒ½æº": 0.0007000000000000001,
        "åŸææ–™": 0.0084
      }
    },
    {
      "code": "DMA056",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "è¯åšæŠ•ä¿¡",
      "name": "ç’°çƒæ–°ç›Š",
      "scale": 357076984.75970006,
      "stock_allocation": 85.49,
      "bond_allocation": 12.24,
      "volatility": 0.071191,
      "drawdown_rate": 0.0,
      "perf_3m": 5.1077,
      "perf_6m": 12.3953,
      "perf_1y": 9.5553,
      "perf_2y": 28.4642,
      "perf_since": 35.811,
      "markets": {
        "ç¾åœ‹": 0.3419,
        "æ­æ´²": 0.1314,
        "æ—¥æœ¬": 0.0296,
        "ä¸­åœ‹": 0.008,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.11346044061922357,
        "æ ¸å¿ƒæ¶ˆè²»": 0.05040104867631437,
        "é†«ç™‚ä¿å¥": 0.08138624469296954,
        "è³‡è¨ŠæŠ€è¡“": 0.28773486646114926,
        "é€šè¨Šæœå‹™": 0.09994288747329026,
        "å…¬ç”¨äº‹æ¥­": 0.014054974155062013,
        "æˆ¿åœ°ç”¢": 0.016566910868622366,
        "é‡‘è": 0.13819776557482372,
        "å·¥æ¥­": 0.14482896178618823,
        "èƒ½æº": 0.025025783154439606,
        "åŸææ–™": 0.028400116537916926
      }
    },
    {
      "code": "DMA073",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "æŸç‘æŠ•ä¿¡",
      "name": "ç‰¹åˆ¥å„ªåˆ©",
      "scale": 274160146.7875015,
      "stock_allocation": 20.4,
      "bond_allocation": 49.63,
      "volatility": 0.047073000000000004,
      "drawdown_rate": 0.0,
      "perf_3m": 2.2003,
      "perf_6m": 5.5319,
      "perf_1y": 4.6036,
      "perf_2y": 15.4476,
      "perf_since": 15.1849,
      "markets": {
        "ç¾åœ‹": 0.4413,
        "æ­æ´²": 0.1911,
        "æ—¥æœ¬": 0.0232,
        "ä¸­åœ‹": 0.0077,
        "å°ç£": 0.0231,
        "å°åº¦": 0.0088,
        "éŸ“åœ‹": 0.0068,
        "æ±å—äº": 0.0039,
        "å·´è¥¿": 0.0011,
        "å¢¨è¥¿å“¥": 0.0033,
        "æ–°èˆˆæ­": 0.007
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0312,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0111,
        "é†«ç™‚ä¿å¥": 0.0205,
        "è³‡è¨ŠæŠ€è¡“": 0.1295,
        "é€šè¨Šæœå‹™": 0.0311,
        "å…¬ç”¨äº‹æ¥­": 0.0062,
        "æˆ¿åœ°ç”¢": 0.0076,
        "é‡‘è": 0.0504,
        "å·¥æ¥­": 0.0456,
        "èƒ½æº": 0.0054,
        "åŸææ–™": 0.0059
      }
    },
    {
      "code": "DMA015",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "è¯åšæŠ•ä¿¡",
      "name": "ç’°çƒç©©å¥",
      "scale": 307510193.3422454,
      "stock_allocation": 47.72,
      "bond_allocation": 50.019999999999996,
      "volatility": 0.05640799999999999,
      "drawdown_rate": 0.0,
      "perf_3m": 1.8729,
      "perf_6m": 4.7517,
      "perf_1y": 5.8305,
      "perf_2y": 15.9556,
      "perf_since": 22.385,
      "markets": {
        "ç¾åœ‹": 0.3619,
        "æ­æ´²": 0.1223,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.09791943157589002,
        "æ ¸å¿ƒæ¶ˆè²»": 0.04058989330335271,
        "é†«ç™‚ä¿å¥": 0.10094005863566571,
        "è³‡è¨ŠæŠ€è¡“": 0.26984446382899446,
        "é€šè¨Šæœå‹™": 0.10754851450054198,
        "å…¬ç”¨äº‹æ¥­": 0.01766944904609259,
        "æˆ¿åœ°ç”¢": 0.011747315059862816,
        "é‡‘è": 0.17900695201811706,
        "å·¥æ¥­": 0.12226218148723514,
        "èƒ½æº": 0.030880054362146126,
        "åŸææ–™": 0.021591686182101406
      }
    },
    {
      "code": "DMA047",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å¯Œé”æŠ•ä¿¡",
      "name": "è¶¨å‹¢å‰µæ–°",
      "scale": 150844565.3051882,
      "stock_allocation": 88.48,
      "bond_allocation": 10.97,
      "volatility": 0.108392,
      "drawdown_rate": 0.0625,
      "perf_3m": 6.4409,
      "perf_6m": 13.4707,
      "perf_1y": 13.2802,
      "perf_2y": 33.1689,
      "perf_since": 69.94,
      "markets": {
        "ç¾åœ‹": 0.5453,
        "æ­æ´²": 0.0897,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0738,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0,
        "é†«ç™‚ä¿å¥": 0.0857,
        "è³‡è¨ŠæŠ€è¡“": 0.2297,
        "é€šè¨Šæœå‹™": 0.0,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0,
        "å·¥æ¥­": 0.0189,
        "èƒ½æº": 0.0,
        "åŸææ–™": 0.0
      }
    },
    {
      "code": "DMA066",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "æ™ºå‹•å› å­",
      "scale": 126229902.67403537,
      "stock_allocation": 58.69259999999999,
      "bond_allocation": 33.2564,
      "volatility": 0.096909,
      "drawdown_rate": 0.0,
      "perf_3m": 3.1439,
      "perf_6m": 7.5469,
      "perf_1y": 8.7713,
      "perf_2y": 23.7142,
      "perf_since": 20.889,
      "markets": {
        "ç¾åœ‹": 0.7042546163154201,
        "æ­æ´²": 0.16419566826708004,
        "æ—¥æœ¬": 0.009787136541120001,
        "ä¸­åœ‹": 0.0024149609143800004,
        "å°ç£": 0.00182299392429,
        "å°åº¦": 0.00170158998905,
        "éŸ“åœ‹": 0.00119165158371,
        "æ±å—äº": 0.00224307290691,
        "å·´è¥¿": 0.00041733195525000004,
        "å¢¨è¥¿å“¥": 0.00051158724211,
        "æ–°èˆˆæ­": 0.00029612037587999995
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.06586211177581,
        "æ ¸å¿ƒæ¶ˆè²»": 0.13343876057446,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.16571350285979,
        "é€šè¨Šæœå‹™": 0.10283580929626,
        "å…¬ç”¨äº‹æ¥­": 0.03387027078213,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.17773873444053,
        "å·¥æ¥­": 0.07734412583274002,
        "èƒ½æº": 0.03793342164808,
        "åŸææ–™": 0.017037939518709997
      }
    },
    {
      "code": "DMA083",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "å°ç£é‡‘è´Š",
      "scale": 356346267.7761001,
      "stock_allocation": 92.42999999999999,
      "bond_allocation": 0.0,
      "volatility": 0.21681,
      "drawdown_rate": 0.0,
      "perf_3m": 11.3693,
      "perf_6m": 36.4343,
      "perf_1y": 22.3802,
      "perf_2y": 64.8257,
      "perf_since": 56.3815,
      "markets": {
        "ç¾åœ‹": 0.0,
        "æ­æ´²": 0.0,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0,
        "å°ç£": 0.9242999999999999,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.009697193718000001,
        "æ ¸å¿ƒæ¶ˆè²»": 0.027534157752999996,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.41729371448999997,
        "é€šè¨Šæœå‹™": 0.046717274397000005,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.01573226961,
        "å·¥æ¥­": 0.212093372093,
        "èƒ½æº": 0.000129147123,
        "åŸææ–™": 0.015339961571999999
      }
    },
    {
      "code": "DMA120",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "ç§‘æŠ€æ™ºé¸",
      "scale": 605001497.1142902,
      "stock_allocation": 65.33,
      "bond_allocation": 26.8,
      "volatility": 0.117389,
      "drawdown_rate": 0.0,
      "perf_3m": 3.5374,
      "perf_6m": 8.5103,
      "perf_1y": 6.0348,
      "perf_2y": null,
      "perf_since": 9.624,
      "markets": {
        "ç¾åœ‹": 0.7836678557269999,
        "æ­æ´²": 0.02962924605699999,
        "æ—¥æœ¬": 0.00187855226,
        "ä¸­åœ‹": 0.001795683349,
        "å°ç£": 0.0047174063920000005,
        "å°åº¦": 0.0007927679580000001,
        "éŸ“åœ‹": 0.000497381843,
        "æ±å—äº": 0.0033993233970000002,
        "å·´è¥¿": 0.0009794826280000001,
        "å¢¨è¥¿å“¥": 0.0029483631090000003,
        "æ–°èˆˆæ­": 0.0022093772630000005
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.04957203767400001,
        "æ ¸å¿ƒæ¶ˆè²»": 0.079582851919,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.24027116225099998,
        "é€šè¨Šæœå‹™": 0.159054436292,
        "å…¬ç”¨äº‹æ¥­": 0.022943319269000003,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.09115801188000003,
        "å·¥æ¥­": 0.037784318564999995,
        "èƒ½æº": 0.025156405607000002,
        "åŸææ–™": 0.007209140998
      }
    },
    {
      "code": "DMA023",
      "insurance_company": "æ³•å·´äººå£½",
      "fund_company": "å¯Œé”æŠ•ä¿¡",
      "name": "é‡‘é‡‡æ”¶ç›Š",
      "scale": 233514703.6196692,
      "stock_allocation": 66.67,
      "bond_allocation": 30.099999999999998,
      "volatility": 0.086399,
      "drawdown_rate": 0.0,
      "perf_3m": 3.2727,
      "perf_6m": 8.4491,
      "perf_1y": 8.5581,
      "perf_2y": 24.449,
      "perf_since": 26.7543,
      "markets": {
        "ç¾åœ‹": 0.2906,
        "æ­æ´²": 0.0864,
        "æ—¥æœ¬": 0.0537,
        "ä¸­åœ‹": 0.0303,
        "å°ç£": 0.0,
        "å°åº¦": 0.0336,
        "éŸ“åœ‹": 0.02,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0155,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0,
        "é†«ç™‚ä¿å¥": 0.0,
        "è³‡è¨ŠæŠ€è¡“": 0.0259,
        "é€šè¨Šæœå‹™": 0.0,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0469,
        "å·¥æ¥­": 0.0157,
        "èƒ½æº": 0.0201,
        "åŸææ–™": 0.0
      }
    },
    {
      "code": "FFUPC018",
      "insurance_company": "å®‰é”äººå£½",
      "fund_company": "ç€šäºæŠ•ä¿¡",
      "name": "å¹´å¹´å®ˆæˆ",
      "scale": 585148077.5785094,
      "stock_allocation": 49.14,
      "bond_allocation": 47.63,
      "volatility": 0.091205,
      "drawdown_rate": 0.0,
      "perf_3m": 3.358,
      "perf_6m": 7.5215,
      "perf_1y": 6.1743,
      "perf_2y": 20.8307,
      "perf_since": 13.976,
      "markets": {
        "ç¾åœ‹": 0.3102,
        "æ­æ´²": 0.0735,
        "æ—¥æœ¬": 0.0289,
        "ä¸­åœ‹": 0.0152,
        "å°ç£": 0.0154,
        "å°åº¦": 0.01,
        "éŸ“åœ‹": 0.0082,
        "æ±å—äº": 0.0049,
        "å·´è¥¿": 0.0027,
        "å¢¨è¥¿å“¥": 0.0012,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0919,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0427,
        "é†«ç™‚ä¿å¥": 0.0751,
        "è³‡è¨ŠæŠ€è¡“": 0.3274,
        "é€šè¨Šæœå‹™": 0.0843,
        "å…¬ç”¨äº‹æ¥­": 0.035,
        "æˆ¿åœ°ç”¢": 0.0176,
        "é‡‘è": 0.1554,
        "å·¥æ¥­": 0.112,
        "èƒ½æº": 0.026,
        "åŸææ–™": 0.0298
      }
    },
    {
      "code": "FFUTS023",
      "insurance_company": "å®‰é”äººå£½",
      "fund_company": "å°æ–°æŠ•ä¿¡",
      "name": "ç¾æ­æˆ°ç•¥",
      "scale": 437928246.252672,
      "stock_allocation": 95.78999999999999,
      "bond_allocation": 0.0,
      "volatility": 0.140684,
      "drawdown_rate": 0.0,
      "perf_3m": 1.6844,
      "perf_6m": 4.8611,
      "perf_1y": 5.7826,
      "perf_2y": 11.8025,
      "perf_since": 11.8025,
      "markets": {
        "ç¾åœ‹": 0.7035,
        "æ­æ´²": 0.2544,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.0,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0626,
        "æ ¸å¿ƒæ¶ˆè²»": 0.2393,
        "é†«ç™‚ä¿å¥": 0.1733,
        "è³‡è¨ŠæŠ€è¡“": 0.0,
        "é€šè¨Šæœå‹™": 0.1758,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.1786,
        "é‡‘è": 0.0,
        "å·¥æ¥­": 0.0,
        "èƒ½æº": 0.065,
        "åŸææ–™": 0.0633
      }
    },
    {
      "code": "FFUPM014",
      "insurance_company": "å®‰é”äººå£½",
      "fund_company": "çµ±ä¸€æŠ•ä¿¡",
      "name": "è‡´å¯Œæœªä¾†",
      "scale": 308421867.2568917,
      "stock_allocation": 75.76,
      "bond_allocation": 12.7,
      "volatility": 0.14055199999999998,
      "drawdown_rate": 0.0,
      "perf_3m": 5.4799,
      "perf_6m": 12.0563,
      "perf_1y": 6.8933,
      "perf_2y": 31.0754,
      "perf_since": 1.6874,
      "markets": {
        "ç¾åœ‹": 0.6963,
        "æ­æ´²": 0.0,
        "æ—¥æœ¬": 0.0,
        "ä¸­åœ‹": 0.015,
        "å°ç£": 0.0,
        "å°åº¦": 0.0,
        "éŸ“åœ‹": 0.0,
        "æ±å—äº": 0.0,
        "å·´è¥¿": 0.0,
        "å¢¨è¥¿å“¥": 0.0,
        "æ–°èˆˆæ­": 0.0
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0,
        "æ ¸å¿ƒæ¶ˆè²»": 0.0,
        "é†«ç™‚ä¿å¥": 0.0154,
        "è³‡è¨ŠæŠ€è¡“": 0.3404,
        "é€šè¨Šæœå‹™": 0.0201,
        "å…¬ç”¨äº‹æ¥­": 0.0,
        "æˆ¿åœ°ç”¢": 0.0,
        "é‡‘è": 0.0,
        "å·¥æ¥­": 0.0583,
        "èƒ½æº": 0.0,
        "åŸææ–™": 0.0
      }
    },
    {
      "code": "FFTFH028",
      "insurance_company": "å®‰é”äººå£½",
      "fund_company": "å¾©è¯æŠ•ä¿¡",
      "name": "å…¨çƒè´æ–°",
      "scale": 130336808.47209996,
      "stock_allocation": 63.29,
      "bond_allocation": 28.22,
      "volatility": 0.10687200000000001,
      "drawdown_rate": 0.0,
      "perf_3m": 10.2597,
      "perf_6m": 24.1654,
      "perf_1y": 10.8554,
      "perf_2y": 36.1211,
      "perf_since": 36.8034,
      "markets": {
        "ç¾åœ‹": 0.4456,
        "æ­æ´²": 0.0461,
        "æ—¥æœ¬": 0.0263,
        "ä¸­åœ‹": 0.0376,
        "å°ç£": 0.2024,
        "å°åº¦": 0.0079,
        "éŸ“åœ‹": 0.0125,
        "æ±å—äº": 0.013,
        "å·´è¥¿": 0.0073,
        "å¢¨è¥¿å“¥": 0.0101,
        "æ–°èˆˆæ­": 0.0119
      },
      "industries": {
        "éæ ¸å¿ƒæ¶ˆè²»": 0.0481,
        "æ ¸å¿ƒæ¶ˆè²»": 0.017,
        "é†«ç™‚ä¿å¥": 0.0247,
        "è³‡è¨ŠæŠ€è¡“": 0.3212,
        "é€šè¨Šæœå‹™": 0.0411,
        "å…¬ç”¨äº‹æ¥­": 0.0077,
        "æˆ¿åœ°ç”¢": 0.0014,
        "é‡‘è": 0.0688,
        "å·¥æ¥­": 0.068,
        "èƒ½æº": 0.0125,
        "åŸææ–™": 0.0102
      }
    }
  ],
  "market_scores": {
    "ç¾åœ‹": 2,
    "æ­æ´²": 2,
    "æ—¥æœ¬": 2,
    "ä¸­åœ‹": 1,
    "å°ç£": 2,
    "å°åº¦": 1,
    "éŸ“åœ‹": 2,
    "æ±å—äº": 0,
    "å·´è¥¿": 0,
    "å¢¨è¥¿å“¥": 0,
    "æ–°èˆˆæ­": 1
  },
  "industry_scores": {
    "éæ ¸å¿ƒæ¶ˆè²»": 0.0,
    "é†«ç™‚ä¿å¥": 1.0,
    "è³‡è¨ŠæŠ€è¡“": 2.0,
    "é€šè¨Šæœå‹™": 1.0,
    "å…¬ç”¨äº‹æ¥­": 2.0,
    "æˆ¿åœ°ç”¢": 2.0,
    "é‡‘è": 2.0,
    "èƒ½æº": 0.0,
    "åŸææ–™": 0.0
  },
  "target_allocation": {
    "stock": 60,
    "bond": 40
  }
};
        
        const WEIGHTS = {
            performance: 0.45,
            market: 0.15,
            industry: 0.15,
            allocation: 0.15,
            volatility: 0.10,
            drawdownBonus: 0.05
        };
        
        const SCALE_THRESHOLD = 800000000;
        
        // å¸‚å ´åˆ†æç›¸é—œè®Šæ•¸
        let uploadedFiles = [];
        let marketCharts = [];
        
        // ==================== é ç±¤åˆ‡æ› ====================
        function switchTab(tabName) {
            // éš±è—æ‰€æœ‰é ç±¤å…§å®¹
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰é ç±¤çš„activeç‹€æ…‹
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // é¡¯ç¤ºé¸ä¸­çš„é ç±¤
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
        
        // ==================== å¸³æˆ¶è©•åˆ†ç³»çµ±åŠŸèƒ½ ====================
        function percentileRank(arr, value) {
            const sorted = [...arr].sort((a, b) => a - b);
            let count = 0;
            for (let v of sorted) {
                if (v < value) count++;
            }
            return count / sorted.length;
        }
        
        function calculateScores(accounts, marketScores, industryScores, targetAllocation) {
            const results = [];
            
            const perf3mData = accounts.map(a => a.perf_3m).filter(v => v !== null);
            const perf6mData = accounts.map(a => a.perf_6m).filter(v => v !== null);
            const perf1yData = accounts.map(a => a.perf_1y).filter(v => v !== null);
            const perf2yData = accounts.map(a => a.perf_2y).filter(v => v !== null);
            const perfSinceData = accounts.map(a => a.perf_since).filter(v => v !== null);
            const volatilityData = accounts.map(a => a.volatility).filter(v => v !== null);
            
            const stockDiffs = accounts.map(a => 
                Math.abs(a.stock_allocation - targetAllocation.stock)
            );
            const bondDiffs = accounts.map(a => 
                Math.abs(a.bond_allocation - targetAllocation.bond)
            );
            
            for (let account of accounts) {
                let perfScore = 0;
                let perfCount = 0;
                
                if (account.perf_3m !== null) {
                    perfScore += percentileRank(perf3mData, account.perf_3m);
                    perfCount++;
                }
                if (account.perf_6m !== null) {
                    perfScore += percentileRank(perf6mData, account.perf_6m);
                    perfCount++;
                }
                if (account.perf_1y !== null) {
                    perfScore += percentileRank(perf1yData, account.perf_1y);
                    perfCount++;
                }
                if (account.perf_2y !== null) {
                    perfScore += percentileRank(perf2yData, account.perf_2y);
                    perfCount++;
                }
                if (account.perf_since !== null) {
                    perfScore += percentileRank(perfSinceData, account.perf_since);
                    perfCount++;
                }
                
                let marketScore = 0;
                for (let [market, weight] of Object.entries(account.markets || {})) {
                    const score = marketScores[market] || 0;
                    marketScore += weight * score;
                }
                
                let industryScore = 0;
                for (let [industry, weight] of Object.entries(account.industries || {})) {
                    const score = industryScores[industry] || 0;
                    industryScore += weight * score;
                }
                
                const stockDiff = Math.abs(account.stock_allocation - targetAllocation.stock);
                const bondDiff = Math.abs(account.bond_allocation - targetAllocation.bond);
                const stockScore = 1 - percentileRank(stockDiffs, stockDiff);
                const bondScore = 1 - percentileRank(bondDiffs, bondDiff);
                const allocationScore = stockScore + bondScore;
                
                const volatilityScore = account.volatility !== null ? 
                    (1 - percentileRank(volatilityData, account.volatility)) : 0;
                
                const drawdownBonus = (account.drawdown_rate || 0) > 0.4 ? 0.05 : 0;
                
                const totalScore = 
                    (perfScore * WEIGHTS.performance) +
                    (marketScore * WEIGHTS.market) +
                    (industryScore * WEIGHTS.industry) +
                    (allocationScore * WEIGHTS.allocation) +
                    (volatilityScore * WEIGHTS.volatility) +
                    drawdownBonus;
                
                results.push({
                    account: account,
                    scores: {
                        performance: perfScore,
                        market: marketScore,
                        industry: industryScore,
                        allocation: allocationScore,
                        volatility: volatilityScore,
                        drawdownBonus: drawdownBonus,
                        total: totalScore
                    },
                    excluded: account.scale < SCALE_THRESHOLD
                });
            }
            
            results.sort((a, b) => b.scores.total - a.scores.total);
            
            let rank = 1;
            for (let result of results) {
                if (!result.excluded) {
                    result.rank = rank++;
                } else {
                    result.rank = null;
                }
            }
            
            return results;
        }
        
        function displayResults(results) {
            const qualified = results.filter(r => !r.excluded).length;
            const excluded = results.filter(r => r.excluded).length;
            
            document.getElementById('totalAccounts').textContent = results.length;
            document.getElementById('qualifiedAccounts').textContent = qualified;
            document.getElementById('excludedAccounts').textContent = excluded;
            
            let html = '<table><thead><tr>';
            html += '<th>æ’å</th>';
            html += '<th>ä»£è™Ÿ</th>';
            html += '<th>å¸³æˆ¶åç¨±</th>';
            html += '<th>ä¿éšªå…¬å¸</th>';
            html += '<th>æŠ•ä¿¡</th>';
            html += '<th>è¦æ¨¡ (å„„)</th>';
            html += '<th>ç¸½åˆ†</th>';
            html += '<th>ç¸¾æ•ˆåˆ†</th>';
            html += '<th>å¸‚å ´åˆ†</th>';
            html += '<th>ç”¢æ¥­åˆ†</th>';
            html += '<th>è‚¡å‚µåˆ†</th>';
            html += '<th>æ³¢å‹•åˆ†</th>';
            html += '<th>å‚™è¨»</th>';
            html += '</tr></thead><tbody>';
            
            for (let result of results) {
                const acc = result.account;
                const scores = result.scores;
                const rowClass = result.excluded ? 'excluded-row' : '';
                
                html += `<tr class="${rowClass}">`;
                
                if (result.excluded) {
                    html += '<td><span class="excluded-badge">æ’é™¤</span></td>';
                } else {
                    const rankClass = result.rank === 1 ? 'rank-1' : 
                                    result.rank === 2 ? 'rank-2' : 
                                    result.rank === 3 ? 'rank-3' : 'rank-other';
                    html += `<td><span class="rank-badge ${rankClass}">${result.rank}</span></td>`;
                }
                
                html += `<td>${acc.code}</td>`;
                html += `<td><strong>${acc.name}</strong></td>`;
                html += `<td>${acc.insurance_company}</td>`;
                html += `<td>${acc.fund_company}</td>`;
                html += `<td>${(acc.scale / 100000000).toFixed(2)}</td>`;
                html += `<td class="score-cell">${scores.total.toFixed(4)}</td>`;
                html += `<td>${scores.performance.toFixed(4)}</td>`;
                html += `<td>${scores.market.toFixed(4)}</td>`;
                html += `<td>${scores.industry.toFixed(4)}</td>`;
                html += `<td>${scores.allocation.toFixed(4)}</td>`;
                html += `<td>${scores.volatility.toFixed(4)}</td>`;
                
                let notes = [];
                if (result.excluded) {
                    notes.push('è¦æ¨¡<8å„„');
                }
                if (scores.drawdownBonus > 0) {
                    notes.push('æ’¥å›åŠ åˆ†');
                }
                html += `<td>${notes.join(', ')}</td>`;
                
                html += '</tr>';
            }
            
            html += '</tbody></table>';
            document.getElementById('results').innerHTML = html;
        }
        
        function exportToExcel() {
            try {
                if (typeof XLSX === 'undefined') {
                    showStatus('éŒ¯èª¤ï¼šXLSX å‡½å¼åº«æœªè¼‰å…¥ï¼Œç„¡æ³•åŒ¯å‡º Excel', 'error');
                    return;
                }
                
                const results = calculateScores(
                    DATA.accounts,
                    DATA.market_scores,
                    DATA.industry_scores,
                    DATA.target_allocation
                );
                
                const exportData = [];
                for (let result of results) {
                    const acc = result.account;
                    const scores = result.scores;
                    
                    exportData.push({
                        'æ’å': result.excluded ? 'æ’é™¤' : result.rank,
                        'ä»£è™Ÿ': acc.code,
                        'å¸³æˆ¶åç¨±': acc.name,
                        'ä¿éšªå…¬å¸': acc.insurance_company,
                        'æŠ•ä¿¡': acc.fund_company,
                        'è¦æ¨¡(å„„)': (acc.scale / 100000000).toFixed(2),
                        'ç¸½åˆ†': scores.total.toFixed(4),
                        'ç¸¾æ•ˆåˆ†æ•¸': scores.performance.toFixed(4),
                        'å¸‚å ´åˆ†æ•¸': scores.market.toFixed(4),
                        'ç”¢æ¥­åˆ†æ•¸': scores.industry.toFixed(4),
                        'è‚¡å‚µåˆ†æ•¸': scores.allocation.toFixed(4),
                        'æ³¢å‹•åˆ†æ•¸': scores.volatility.toFixed(4),
                        'åŠ ç¢¼æ’¥å›åŠ åˆ†': scores.drawdownBonus.toFixed(2),
                        'è‚¡ç¥¨é…ç½®(%)': acc.stock_allocation.toFixed(2),
                        'å‚µåˆ¸é…ç½®(%)': acc.bond_allocation.toFixed(2),
                        'æ³¢å‹•åº¦': acc.volatility ? acc.volatility.toFixed(4) : '',
                        'åŠ ç¢¼æ’¥å›ç‡': acc.drawdown_rate ? (acc.drawdown_rate * 100).toFixed(2) + '%' : '',
                        '3å€‹æœˆå ±é…¬': acc.perf_3m !== null ? acc.perf_3m.toFixed(4) : '',
                        '6å€‹æœˆå ±é…¬': acc.perf_6m !== null ? acc.perf_6m.toFixed(4) : '',
                        '1å¹´å ±é…¬': acc.perf_1y !== null ? acc.perf_1y.toFixed(4) : '',
                        '2å¹´å ±é…¬': acc.perf_2y !== null ? acc.perf_2y.toFixed(4) : '',
                        'æˆç«‹è‡³ä»Šå ±é…¬': acc.perf_since !== null ? acc.perf_since.toFixed(4) : '',
                        'å‚™è¨»': result.excluded ? 'è¦æ¨¡ä¸è¶³8å„„' : (scores.drawdownBonus > 0 ? 'æ’¥å›åŠ åˆ†' : '')
                    });
                }
                
                const ws = XLSX.utils.json_to_sheet(exportData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'å¸³æˆ¶è©•åˆ†çµæœ');
                
                const fileName = `é¡å…¨å§”å¸³æˆ¶è©•åˆ†å ±å‘Š_${new Date().toISOString().slice(0,10)}.xlsx`;
                XLSX.writeFile(wb, fileName);
                
                showStatus(`âœ“ æˆåŠŸåŒ¯å‡ºï¼š${fileName}`, 'success');
            } catch (error) {
                console.error('åŒ¯å‡ºéŒ¯èª¤:', error);
                showStatus('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
            }
        }
        
        function processUploadedFiles() {
            const accountFile = document.getElementById('accountFile').files[0];
            const strategyFile = document.getElementById('strategyFile').files[0];
            
            if (!accountFile || !strategyFile) {
                showStatus('è«‹é¸æ“‡å…©å€‹ Excel æª”æ¡ˆ', 'error');
                return;
            }
            
            showStatus('æç¤ºï¼šæª”æ¡ˆä¸Šå‚³åŠŸèƒ½éœ€è¦æ ¹æ“šå¯¦éš› Excel çµæ§‹å¯¦ä½œè§£æé‚è¼¯', 'info');
        }
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = 'status-message status-' + type;
            statusDiv.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        // ==================== å¸‚å ´åˆ†æåŠŸèƒ½ ====================
        
        // è™•ç†æª”æ¡ˆä¸Šå‚³
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('marketReports');
            if (fileInput) {
                fileInput.addEventListener('change', handleFileUpload);
            }
        });
        
        function handleFileUpload(event) {
            const files = event.target.files;
            const fileListEl = document.getElementById('fileList');
            
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedFiles.push({
                        name: file.name,
                        size: file.size,
                        content: e.target.result
                    });
                    
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <span class="file-name">${file.name}</span>
                        <span class="file-size">${(file.size / 1024).toFixed(2)} KB</span>
                    `;
                    fileListEl.appendChild(li);
                };
                reader.readAsText(file);
            });
        }
        
        // ç”Ÿæˆå¸‚å ´åˆ†æå ±å‘Š
        function generateMarketReport() {
            const marketInfo = document.getElementById('marketInfoInput').value;
            const reportInput = document.getElementById('reportInput').value;
            
            if (!marketInfo && !reportInput && uploadedFiles.length === 0) {
                showMarketStatus('è«‹è‡³å°‘è¼¸å…¥å¸‚å ´è³‡è¨Šæˆ–ä¸Šå‚³å ±å‘Šæª”æ¡ˆ', 'error');
                return;
            }
            
            showMarketStatus('æ­£åœ¨ç”Ÿæˆå¸‚å ´åˆ†æå ±å‘Š...', 'info');
            
            // æ•´åˆæ‰€æœ‰è³‡æ–™
            let allContent = marketInfo + '\n\n' + reportInput;
            uploadedFiles.forEach(file => {
                allContent += '\n\n' + file.content;
            });
            
            // ç”Ÿæˆå ±å‘Šå…§å®¹
            const reportHTML = generateReportHTML(allContent);
            document.getElementById('reportContent').innerHTML = reportHTML;
            document.getElementById('reportOutput').style.display = 'block';
            
            // ç”Ÿæˆåœ–è¡¨
            setTimeout(() => {
                generateCharts();
                showMarketStatus('âœ“ å¸‚å ´åˆ†æå ±å‘Šç”ŸæˆæˆåŠŸï¼', 'success');
                document.getElementById('reportContent').scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        // ç”Ÿæˆå ±å‘ŠHTML
        function generateReportHTML(content) {
            const today = new Date().toLocaleDateString('zh-TW', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // åˆ†æå…§å®¹ä¸¦ç”Ÿæˆæ™ºæ…§æ‘˜è¦
            const analysis = analyzeMarketContent(content);
            
            return `
                <div class="report-header">
                    <h2>ğŸ“Š å…¨çƒå¸‚å ´åˆ†æå ±å‘Š</h2>
                    <div class="report-date">å ±å‘Šæ—¥æœŸï¼š${today}</div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ“ˆ å…¨çƒè‚¡å¸‚æ¦‚æ³</h3>
                    <div class="report-content">
                        <p>${analysis.globalMarket}</p>
                        <ul class="report-list">
                            <li>ç¾åœ‹è‚¡å¸‚ï¼š${analysis.usMarket}</li>
                            <li>æ­æ´²è‚¡å¸‚ï¼š${analysis.europeMarket}</li>
                            <li>äºå¤ªè‚¡å¸‚ï¼š${analysis.asiaMarket}</li>
                        </ul>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">ä¸»è¦è‚¡å¸‚è¡¨ç¾æ¯”è¼ƒ</div>
                        <canvas id="stockChart"></canvas>
                    </div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ‡¹ğŸ‡¼ å°è‚¡åˆ†æ</h3>
                    <div class="report-content">
                        <p>${analysis.taiwanMarket}</p>
                        <ul class="report-list">
                            <li>åŠ æ¬ŠæŒ‡æ•¸è¡¨ç¾ï¼š${analysis.taiwanIndex}</li>
                            <li>ç”¢æ¥­äº®é»ï¼š${analysis.taiwanIndustry}</li>
                            <li>å¤–è³‡å‹•å‘ï¼š${analysis.foreignInvestor}</li>
                        </ul>
                    </div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ’° å‚µåˆ¸å¸‚å ´</h3>
                    <div class="report-content">
                        <p>${analysis.bondMarket}</p>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">å‚µåˆ¸æ®–åˆ©ç‡èµ°å‹¢</div>
                        <canvas id="bondChart"></canvas>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>å‚µåˆ¸é¡å‹</th>
                                <th>æ®–åˆ©ç‡</th>
                                <th>è®Šå‹•</th>
                                <th>è©•ç´š</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ç¾åœ‹10å¹´æœŸå…¬å‚µ</td>
                                <td>4.2%</td>
                                <td class="positive">+0.1%</td>
                                <td>AAA</td>
                            </tr>
                            <tr>
                                <td>ç¾åœ‹2å¹´æœŸå…¬å‚µ</td>
                                <td>4.5%</td>
                                <td class="negative">-0.05%</td>
                                <td>AAA</td>
                            </tr>
                            <tr>
                                <td>æŠ•è³‡ç´šå…¬å¸å‚µ</td>
                                <td>5.3%</td>
                                <td class="positive">+0.2%</td>
                                <td>BBB</td>
                            </tr>
                            <tr>
                                <td>é«˜æ”¶ç›Šå‚µ</td>
                                <td>7.8%</td>
                                <td class="positive">+0.3%</td>
                                <td>BB</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ¥‡ é»ƒé‡‘èˆ‡è²´é‡‘å±¬</h3>
                    <div class="report-content">
                        <p>${analysis.goldMarket}</p>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">è²´é‡‘å±¬åƒ¹æ ¼èµ°å‹¢</div>
                        <canvas id="goldChart"></canvas>
                    </div>
                </div>
                
                <div class="report-section">
                    <h3>ğŸ’¡ æŠ•è³‡å»ºè­°</h3>
                    <div class="report-content">
                        <ul class="report-list">
                            <li><strong>è‚¡ç¥¨å¸‚å ´ï¼š</strong>ç¶­æŒä¸­æ€§åå¤šé…ç½®ï¼Œé—œæ³¨ç§‘æŠ€èˆ‡AIç›¸é—œé¡è‚¡ã€‚</li>
                            <li><strong>å‚µåˆ¸å¸‚å ´ï¼š</strong>å»ºè­°å¢æŒçŸ­æœŸå‚µåˆ¸ï¼Œç­‰å¾…æ›´ä½³é€²å ´æ™‚æ©Ÿã€‚</li>
                            <li><strong>é»ƒé‡‘é…ç½®ï¼š</strong>å»ºè­°ç¶­æŒ5-10%çš„é»ƒé‡‘é…ç½®ä½œç‚ºé¿éšªã€‚</li>
                            <li><strong>é¢¨éšªç®¡ç†ï¼š</strong>å¯†åˆ‡é—œæ³¨å¤®è¡Œæ”¿ç­–èˆ‡é€šè†¨æ•¸æ“šè®ŠåŒ–ã€‚</li>
                        </ul>
                    </div>
                </div>
                
                <div class="report-section">
                    <h3>âš ï¸ é¢¨éšªæç¤º</h3>
                    <div class="report-content">
                        <ul class="report-list">
                            <li>åœ°ç·£æ”¿æ²»é¢¨éšªæŒçºŒå­˜åœ¨</li>
                            <li>é€šè†¨æ•¸æ“šå¯èƒ½åè¦†</li>
                            <li>å¤®è¡Œæ”¿ç­–è½‰å‘çš„ä¸ç¢ºå®šæ€§</li>
                            <li>å¸‚å ´æ³¢å‹•å¯èƒ½åŠ åŠ‡</li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        // åˆ†æå¸‚å ´å…§å®¹
        function analyzeMarketContent(content) {
            // åŸºç¤åˆ†æé‚è¼¯ï¼ˆå¯æ ¹æ“šå¯¦éš›éœ€æ±‚æ“´å±•ï¼‰
            const hasUSMarket = content.includes('ç¾è‚¡') || content.includes('S&P') || content.includes('é“ç“Š');
            const hasTaiwanMarket = content.includes('å°è‚¡') || content.includes('åŠ æ¬Š');
            const hasBond = content.includes('å‚µåˆ¸') || content.includes('æ®–åˆ©ç‡');
            const hasGold = content.includes('é»ƒé‡‘') || content.includes('è²´é‡‘å±¬');
            
            return {
                globalMarket: 'å…¨çƒä¸»è¦è‚¡å¸‚åœ¨ç§‘æŠ€è‚¡çš„å¸¶å‹•ä¸‹æ™®éä¸Šæ¼²ï¼ŒæŠ•è³‡äººå°ç¶“æ¿Ÿå‰æ™¯ä¿æŒæ¨‚è§€æ…‹åº¦ã€‚ç¾åœ‹è¯æº–æœƒç¶­æŒç¾è¡Œåˆ©ç‡æ”¿ç­–ï¼Œå¸‚å ´å°è»Ÿè‘—é™¸é æœŸå‡æº«ã€‚',
                usMarket: hasUSMarket ? 'ç§‘æŠ€è‚¡é ˜æ¼²ï¼ŒAIç›¸é—œé¡è‚¡è¡¨ç¾äº®çœ¼ï¼ŒæŒ‡æ•¸å‰µè¿‘æœŸæ–°é«˜' : 'S&P 500æŒ‡æ•¸è¡¨ç¾ç©©å¥ï¼Œç§‘æŠ€è‚¡æŒçºŒé ˜æ¼²',
                europeMarket: 'æ­æ´²å¤®è¡Œç¶­æŒåˆ©ç‡ä¸è®Šï¼Œç¶“æ¿Ÿæ•¸æ“šé¡¯ç¤ºå¾©ç”¦è·¡è±¡ï¼Œè£½é€ æ¥­PMIå›å‡',
                asiaMarket: 'äºæ´²å¸‚å ´æ¼²è·Œäº’è¦‹ï¼Œæ—¥æœ¬è‚¡å¸‚å—æ—¥åœ“èµ°å¼±å½±éŸ¿è¡¨ç¾å¼·å‹',
                taiwanMarket: hasTaiwanMarket ? 'å°è‚¡åœ¨åŠå°é«”ç”¢æ¥­æ”¯æ’ä¸‹è¡¨ç¾ç©©å¥ï¼Œå¤–è³‡æŒçºŒæµå…¥ï¼Œå¸‚å ´ä¿¡å¿ƒå›æº«ã€‚' : 'å°è‚¡åŠ æ¬ŠæŒ‡æ•¸ç©©å¥ä¸Šæšï¼ŒåŠå°é«”åŠAIæ¦‚å¿µè‚¡é ˜æ¼²ï¼Œå¸‚å ´æˆäº¤é‡æ´»çµ¡ã€‚',
                taiwanIndex: 'åŠ æ¬ŠæŒ‡æ•¸æ”¶ç›¤å‰µè¿‘æœŸæ–°é«˜ï¼Œæˆäº¤é‡ç¶­æŒé«˜æª”',
                taiwanIndustry: 'åŠå°é«”ã€AIã€é›»å‹•è»Šä¾›æ‡‰éˆè¡¨ç¾çªå‡º',
                foreignInvestor: 'å¤–è³‡è¿‘æœŸæŒçºŒè²·è¶…ï¼Œèšç„¦ç§‘æŠ€é¾é ­è‚¡',
                bondMarket: hasBond ? 'å‚µåˆ¸å¸‚å ´å—åˆ©ç‡é æœŸå½±éŸ¿ï¼Œé•·çŸ­æœŸåˆ©å·®æŒçºŒæ”¶çª„ã€‚æŠ•è³‡ç´šå‚µåˆ¸ç²è³‡é‡‘é’çï¼Œæ®–åˆ©ç‡ç¶­æŒåœ¨ç›¸å°é«˜æª”ã€‚' : 'ç¾åœ‹å…¬å‚µæ®–åˆ©ç‡æ³¢å‹•åŠ åŠ‡ï¼Œå¸‚å ´å¯†åˆ‡é—œæ³¨è¯æº–æœƒæ”¿ç­–å‹•å‘ã€‚é•·æœŸå‚µåˆ¸éœ€æ±‚å›å‡ï¼Œæ®–åˆ©ç‡æ›²ç·šè¶¨æ–¼å¹³å¦ã€‚',
                goldMarket: hasGold ? 'é»ƒé‡‘åƒ¹æ ¼åœ¨é¿éšªéœ€æ±‚æ”¯æ’ä¸‹ç¶­æŒé«˜æª”ï¼Œåœ°ç·£æ”¿æ²»ä¸ç¢ºå®šæ€§æ¨å‡æŠ•è³‡äººé…ç½®æ„é¡˜ã€‚' : 'ç¾è²¨é»ƒé‡‘åƒ¹æ ¼ç¶­æŒåœ¨æ¯ç›å¸2,000ç¾å…ƒä»¥ä¸Šï¼Œé¿éšªéœ€æ±‚æŒçºŒæ”¯æ’é‡‘åƒ¹ã€‚å¤®è¡ŒæŒçºŒè³¼é‡‘ï¼Œé•·æœŸè¶¨å‹¢çœ‹å¥½ã€‚'
            };
        }
        
        // ç”Ÿæˆåœ–è¡¨
        function generateCharts() {
            // éŠ·æ¯€èˆŠåœ–è¡¨
            marketCharts.forEach(chart => chart.destroy());
            marketCharts = [];
            
            // è‚¡å¸‚è¡¨ç¾åœ–è¡¨
            const stockCtx = document.getElementById('stockChart');
            if (stockCtx) {
                const stockChart = new Chart(stockCtx, {
                    type: 'bar',
                    data: {
                        labels: ['ç¾åœ‹', 'æ­æ´²', 'æ—¥æœ¬', 'å°ç£', 'ä¸­åœ‹', 'å°åº¦'],
                        datasets: [{
                            label: 'å¹´åˆè‡³ä»Šå ±é…¬ç‡ (%)',
                            data: [22.5, 15.3, 28.7, 18.9, -5.2, 16.8],
                            backgroundColor: [
                                'rgba(102, 126, 234, 0.8)',
                                'rgba(118, 75, 162, 0.8)',
                                'rgba(237, 100, 166, 0.8)',
                                'rgba(255, 154, 158, 0.8)',
                                'rgba(250, 208, 196, 0.8)',
                                'rgba(156, 204, 254, 0.8)'
                            ],
                            borderColor: [
                                'rgba(102, 126, 234, 1)',
                                'rgba(118, 75, 162, 1)',
                                'rgba(237, 100, 166, 1)',
                                'rgba(255, 154, 158, 1)',
                                'rgba(250, 208, 196, 1)',
                                'rgba(156, 204, 254, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        }
                    }
                });
                stockChart.canvas.style.height = '300px';
                marketCharts.push(stockChart);
            }
            
            // å‚µåˆ¸æ®–åˆ©ç‡åœ–è¡¨
            const bondCtx = document.getElementById('bondChart');
            if (bondCtx) {
                const bondChart = new Chart(bondCtx, {
                    type: 'line',
                    data: {
                        labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                        datasets: [{
                            label: 'ç¾åœ‹10å¹´æœŸå…¬å‚µæ®–åˆ©ç‡',
                            data: [3.8, 3.9, 4.1, 4.3, 4.2, 4.0, 4.1, 4.2, 4.3, 4.2, 4.3, 4.2],
                            borderColor: 'rgba(102, 126, 234, 1)',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'ç¾åœ‹2å¹´æœŸå…¬å‚µæ®–åˆ©ç‡',
                            data: [4.2, 4.3, 4.5, 4.7, 4.6, 4.4, 4.5, 4.6, 4.7, 4.5, 4.6, 4.5],
                            borderColor: 'rgba(237, 100, 166, 1)',
                            backgroundColor: 'rgba(237, 100, 166, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        }
                    }
                });
                bondChart.canvas.style.height = '300px';
                marketCharts.push(bondChart);
            }
            
            // é»ƒé‡‘åƒ¹æ ¼åœ–è¡¨
            const goldCtx = document.getElementById('goldChart');
            if (goldCtx) {
                const goldChart = new Chart(goldCtx, {
                    type: 'line',
                    data: {
                        labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                        datasets: [{
                            label: 'é»ƒé‡‘ (ç¾å…ƒ/ç›å¸)',
                            data: [1850, 1880, 1920, 1980, 2000, 1950, 1980, 2020, 2050, 2080, 2100, 2050],
                            borderColor: 'rgba(255, 193, 7, 1)',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            tension: 0.4,
                            fill: true,
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                ticks: {
                                    callback: function(value) {
                                        return '$' + value;
                                    }
                                }
                            }
                        }
                    }
                });
                goldChart.canvas.style.height = '300px';
                marketCharts.push(goldChart);
            }
        }
        
        // åŒ¯å‡ºPDF
        async function exportReportToPDF() {
            const reportContent = document.getElementById('reportContent');
            
            if (!reportContent || reportContent.innerHTML.trim() === '') {
                showMarketStatus('è«‹å…ˆç”Ÿæˆå¸‚å ´åˆ†æå ±å‘Š', 'error');
                return;
            }
            
            showMarketStatus('æ­£åœ¨ç”Ÿæˆ PDFï¼Œè«‹ç¨å€™...', 'info');
            
            try {
                // ä½¿ç”¨html2canvasæˆªåœ–
                const canvas = await html2canvas(reportContent, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                const imgData = canvas.toDataURL('image/png');
                
                // ä½¿ç”¨jsPDFç”ŸæˆPDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });
                
                const imgWidth = 210;
                const pageHeight = 297;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                while (heightLeft > 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                const fileName = `å¸‚å ´åˆ†æå ±å‘Š_${new Date().toISOString().slice(0,10)}.pdf`;
                pdf.save(fileName);
                
                showMarketStatus(`âœ“ æˆåŠŸåŒ¯å‡º PDFï¼š${fileName}`, 'success');
            } catch (error) {
                console.error('PDFåŒ¯å‡ºéŒ¯èª¤:', error);
                showMarketStatus('PDF åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
            }
        }
        
        // æ¸…é™¤å¸‚å ´è³‡æ–™
        function clearMarketData() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å¸‚å ´è³‡æ–™å—ï¼Ÿ')) {
                document.getElementById('marketInfoInput').value = '';
                document.getElementById('reportInput').value = '';
                document.getElementById('fileList').innerHTML = '';
                document.getElementById('reportOutput').style.display = 'none';
                document.getElementById('marketReports').value = '';
                uploadedFiles = [];
                marketCharts.forEach(chart => chart.destroy());
                marketCharts = [];
                showMarketStatus('âœ“ å·²æ¸…é™¤æ‰€æœ‰å¸‚å ´è³‡æ–™', 'success');
            }
        }
        
        function showMarketStatus(message, type) {
            const statusDiv = document.getElementById('marketStatusMessage');
            statusDiv.textContent = message;
            statusDiv.className = 'status-message status-' + type;
            statusDiv.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
        
        // ==================== åˆå§‹åŒ– ====================
        window.addEventListener('DOMContentLoaded', function() {
            const results = calculateScores(
                DATA.accounts,
                DATA.market_scores,
                DATA.industry_scores,
                DATA.target_allocation
            );
            displayResults(results);
        });
    </script>
</body>
</html>